

メガドライブ用アドベンチャーエンジン


メガドライブ開発環境のSGDK用プログラムです。
エクセルファイルに記述されたスクリプトからSGDK用のソースを生成することで
MD向けのプログラムを書かなくても最低限のアドベンチャーゲームが作れることを目指しました。

■環境
・Microsoft Excelが必要です。
・Code::Blocksでの開発を前提にしています。
　開発環境の作成については割愛します。

■利用方法（プロジェクトに組み込む方法）
０.下記サイト様の「Draw_Shift_JIS」を組み込む前提のプログラムになってます。
https://nendo16.jimdofree.com/

「Draw_Shift_JIS」をダウンロードしてプロジェクトフォルダ内に下記のファイルを
同階層に配置して下さい。
	src/draw_sjis.c
	src/draw_sjis.h
	res/sjis_font.png

１．ADV_SYSTEM/src内のファイルをプロジェクトフォルダ内の同階層に配置してください。

２．「adv_system_codecreator.xlsm」の「スクリプト」シートにスクリプトを記述し
　同シート内の「生成」ボタンを押すとプログラムファイルが出力されます。
　出力場所のパスは「設定」シートに入力します。
　出力されたadvsys_data.h、advsys_resource.hがそれぞれsrc、resフォルダ内に配置する
　必要がありますので、基本的に1.にはプロジェクトフォルダ/src、
　2.にはプロジェクトフォルダ/resを設定することを勧めます。
　
	[スクリプト記載方法] 
		シーン名　…　スクリプトのジャンプ先はここに記載された地点を指定する。
		コマンド名、値1、値2、値3、値4　…　コマンドで指定された処理を実行。コマンド種類は下記参照
			STR…値1で指定した文字列を表示
			IPTWAIT…文字列を表示し、ユーザーのコマンド入力（↑←↓→）を待つ
			IPTJMP…必ずIPTWAITの後に指定し、↑←↓→に対応する指定シーンにジャンプ
			（↑：値1で指定したシーン、←：値2で指定したシーン、↓：値3で指定したシーン、→：値4で指定したシーン）
			IF…値1の変数をと値3で指定した数値を値2の演算子で比較し、TRUEの場合値4で指定したシーンへジャンプ。
				記述する演算子は以下
					EQUAL…「＝」（値1＝値3の場合TRUE）
					MORE_THAN…「＞」（値1＞値3の場合TRUE）
					LESS_THAN…「＜」（値1＜値3の場合TRUE）
					E_MORE_THAN「＞＝」（値1＞＝値3の場合TRUE）
					E_LESS_THAN「＜＝」（値1＜＝値3の場合TRUE）
					N_EQUAL…「≠」（値1≠値3の場合TRUE）
			IMG…背景A面に値1で指定した画像を描画。座標は0，0固定、パレットはPAL1固定。
			（パレットは画像から自動生成する）
			画像は値1で指定したものと同名のファイルをresフォルダ内に手動で配置してください。
			SETVAL…値1で指定した変数に値2の数値を格納。
				値1に書かれた変数は自動生成されるので変数定義の記述などは不要。
			ADDVAL…値1で指定した変数に値2の数値を加算。
				値1に書かれた変数は自動生成されるので変数定義の記述などは不要。
			SUBVAL…値1で指定した変数から値2の数値を減算。
				値1に書かれた変数は自動生成されるので変数定義の記述などは不要。
			JMP…値1で指定したシーンへジャンプ
			END…スクリプトの読み込みを停止する。後述のupdate_adv_system()の返り値に値1を設定。

	※エラーチェック等はしてないので不整合な値を設定するとプログラムがコンパイルエラーになる、または
	動作がおかしくなる可能性があります。

３．初期状態ではスクリプトの一番上のシーンから始まるような記述がmain.cに記載されています。
　自作のプログラムから本エンジンを呼び出す場合は下記の関数を用いて実行が可能です。
	void init_adv_system()　エンジンの初期化
		…開始する前に必ず実行する

	void start_adv_system(u16 sceneIdx, u16 vramIdx)　エンジンの開始
		…sceneIdxで指定したシーンからエンジンを開始。
		　（シーンのインデックスはadv_system_codecreator.xlsm（プログラム生成後）
		　の「シーンリスト」B列と対応）
		　本エンジンによる画像表示時、vramIdx以降の番地のVRAMをエンジンで利用する。
		　（上限なし。自前で枠などを描画するときは枠データの分より後を指定する、みたいな用途）
	
	u16 update_adv_system()　エンジンの更新
		…ゲームループ内に記載することで更新が行われる。
		　スクリプトで「END」を指定した地点まで到達した場合、そのフレームで「返却値」に設定した
		　値を返す。それ以外（実行中）は定数「ADV_SYS_NULL」を返す。
		　終了判定を行いたい場合はそれで判別できる。


※sampleフォルダ内にサンプルゲームプロジェクト一式があります。

■その他
	・BGMは鳴らせないんですか？
	→大元のゲームではこのエンジン外で鳴らしてたので実装されてません。すみません。

■ライセンス
	MIT License

■バージョン
	2021/01/24　…　ver1.0

--------------------------------------

ネガティブにゲームを作りたい（別館）
http://negativegame.net/

Mail：hinsyuku@c-error.net

--------------------------------------
